(()=>{var e={};e.id=49,e.ids=[49],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79246:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>p,serverHooks:()=>l,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>v});var a={};r.r(a),r.d(a,{GET:()=>u});var n=r(42706),i=r(28203),s=r(45994),o=r(96330),c=r(39187);let d=new o.PrismaClient;async function u(e){try{let t=e.nextUrl.searchParams,r=t.get("categoryId"),a=t.get("cityId"),n=t.get("search"),i=t.get("sortBy")||"date",s={reviewed:!0};r&&(s.event={categories:{some:{id:r}}}),a&&(s.event={...s.event,cityId:a}),n&&(s.OR=[{title:{contains:n,mode:"insensitive"}},{content:{contains:n,mode:"insensitive"}},{summary:{contains:n,mode:"insensitive"}}]);let o=(await d.blog.findMany({where:s,include:{author:{select:{id:!0,name:!0}},event:{select:{id:!0,eventName:!0,currentParticipants:!0,categories:{select:{id:!0,categoryName:!0}},city:{select:{id:!0,cityName:!0,state:!0}},media:{select:{mediaUrl:!0},take:1}}}},orderBy:"least-viewed"===i?{ratingAverage:"asc"}:{ratingAverage:"desc"}})).map(e=>({id:e.id,title:e.title,content:e.content,summary:e.summary,category:e.event?.categories?.[0]?{id:e.event.categories[0].id,name:e.event.categories[0].categoryName}:{id:"1",name:"General"},city:e.event?.city?{id:e.event.city.id,name:e.event.city.cityName,state:e.event.city.state}:{id:"1",name:"Unknown",state:"Unknown"},author:{id:e.author.id,name:e.author.name},event:e.event?{id:e.event.id,eventName:e.event.eventName,participants:e.event.currentParticipants}:void 0,media:e.event?.media.map(e=>({mediaUrl:e.mediaUrl}))||[],createdAt:e.createdAt.toISOString(),viewCount:e.ratingAverage?Math.round(20*e.ratingAverage):0}));return c.NextResponse.json(o)}catch(e){return console.error("Error fetching blogs:",e),c.NextResponse.json({message:"Error fetching blogs"},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/blogs/route",pathname:"/api/blogs",filename:"route",bundlePath:"app/api/blogs/route"},resolvedPagePath:"E:\\Deepshika\\web development\\Together-We-Can-main\\src\\app\\api\\blogs\\route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:m,workUnitAsyncStorage:v,serverHooks:l}=p;function g(){return(0,s.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:v})}},96487:()=>{},78335:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,5452],()=>r(79246));module.exports=a})();