(()=>{var e={};e.id=7073,e.ids=[7073],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},11723:e=>{"use strict";e.exports=require("querystring")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},65399:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>y,routeModule:()=>c,serverHooks:()=>m,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>v});var i={};r.r(i),r.d(i,{GET:()=>d});var s=r(42706),n=r(28203),a=r(45994),o=r(51825),u=r(37702),l=r(39187);let p=new(r(96330)).PrismaClient;async function d(){try{let e=await (0,o.getServerSession)(u.N);if(!e||!e.user?.email)return l.NextResponse.json({error:"Unauthorized"},{status:401});let t=await p.user.findUnique({where:{email:e.user.email},select:{name:!0,email:!0,age:!0,gender:!0,city:!0,phone:!0,id:!0}});if(!t)return l.NextResponse.json({error:"User not found"},{status:404});let r=(await p.participant.findMany({where:{userId:t.id},include:{event:{select:{id:!0,eventName:!0,startDate:!0,endDate:!0,location:!0,driveCompletion:{select:{testimonials:!0}}}}}})).map(e=>({id:e.event.id,eventName:e.event.eventName,startDate:e.event.startDate,endDate:e.event.endDate,location:e.event.location,driveCompletion:e.event.driveCompletion})),i=(await p.event.findMany({where:{creatorId:t.id},select:{id:!0,eventName:!0,startDate:!0,endDate:!0,location:!0,driveCompletion:{select:{testimonials:!0}}}})).map(e=>({id:e.id,eventName:e.eventName,startDate:e.startDate,endDate:e.endDate,location:e.location,driveCompletion:e.driveCompletion}));return l.NextResponse.json({user:t,participatedDrives:r,createdDrives:i})}catch(e){return console.error("Error in /api/profile:",e),l.NextResponse.json({error:"Failed to load profile",details:e.message||"Unknown error"},{status:500})}finally{await p.$disconnect()}}let c=new s.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/profile/route",pathname:"/api/profile",filename:"route",bundlePath:"app/api/profile/route"},resolvedPagePath:"E:\\Deepshika\\web development\\Together-We-Can-main\\src\\app\\api\\profile\\route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:f,workUnitAsyncStorage:v,serverHooks:m}=c;function y(){return(0,a.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:v})}},96487:()=>{},78335:()=>{},13676:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},51825:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.default}});var s=r(13676);Object.keys(s).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(i,e))&&(e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))});var n=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(void 0);if(r&&r.has(e))return r.get(e);var i={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&({}).hasOwnProperty.call(e,n)){var o=s?Object.getOwnPropertyDescriptor(e,n):null;o&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=e[n]}return i.default=e,r&&r.set(e,i),i}(r(64767));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}Object.keys(n).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(i,e))&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))})},37702:(e,t,r)=>{"use strict";r.d(t,{N:()=>l});var i=r(46814),s=r(96330),n=r(58964),a=r.n(n),o=r(91642);let u=new s.PrismaClient,l={adapter:(0,i.y)(u),providers:[(0,o.A)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)throw Error("Invalid credentials");let t=await u.user.findUnique({where:{email:e.email}});if(!t||!t?.password)throw Error("Invalid credentials");if(!t.emailVerified)throw Error("Please verify your email address before signing in. Check your inbox for a verification link.");if(!await a().compare(e.password,t.password))throw Error("Invalid credentials");return t}})],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id),e),session:async({session:e,token:t})=>(e?.user&&(e.user.id=t.id),e)},session:{strategy:"jwt"},secret:process.env.NEXTAUTH_SECRET,debug:!1,pages:{signIn:"/auth/signin"}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[638,5452,8964,5229],()=>r(65399));module.exports=i})();